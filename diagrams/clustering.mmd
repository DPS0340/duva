
---
title : Clustering
---

sequenceDiagram
    participant s as MasterServer
    
    
    actor Cache
    actor Config
    actor Cluster
    actor peer_listener
    
    actor client_listener
    participant SlaveServer
    actor slave_peer_listener

    par 
        s-->>Cache: spawn
    and 
        s-->>Config: spawn
    and 
        s-->>Cluster: spawn
        Cluster --> Cluster : send heartbeat
        Note right of Cluster : Cluster periodically sends heartbeat to peers 
    and
        s -->>client_listener:spawn
        
    and 
        SlaveServer -->> slave_peer_listener: spawn 
        Note right of SlaveServer : SlaveServer also listens for incoming peer connections
    and 
    

        
        s-->>peer_listener: spawn
        
        loop 
            rect rgb(230, 229, 216)
                SlaveServer -->>+ peer_listener: bind 
                peer_listener -->- SlaveServer: threeway handshake
                peer_listener -->> SlaveServer : disseminate peer infomation
                peer_listener -->>+ Cluster : pass stream
                Cluster -->>- Cluster : add peer

            end
        end
        
  
    end

    
    

 
    